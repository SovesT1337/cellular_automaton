# Реальные результаты работы программы на RTX 3060

## Конфигурация

- **OS**: Linux 6.6.87.2-microsoft-standard-WSL2
- **CPU**: AMD/Intel (WSL2)
- **GPU**: NVIDIA GeForce RTX 3060 (12GB)
- **CUDA**: 13.1 (compute capability 8.6)
- **Драйвер**: 581.80

## Полные результаты тестов

### Случайные графы

#### 1K узлов
```
Узлов: 1000, Рёбер: 4012, Шагов: 100
Функция обратной связи: XOR

[CPU]  Время: 0.419 мс
[CUDA] Время: 7.970 мс
[CPU]  Конечное состояние: 00010111001101001011...
[CUDA] Конечное состояние: 00010111001101001011...
[CPU]  Выходная последовательность (505 бит): 010000100100101111101001011100...
[CUDA] Выходная последовательность (505 бит): 010000100100101111101001011100...

✓ Результаты совпадают
Ускорение: 0.05x (накладные расходы GPU)
```

#### 10K узлов
```
Узлов: 10000, Рёбер: 60004, Шагов: 100
Функция обратной связи: XOR

[CPU]  Время: 9.392 мс
[CUDA] Время: 7.020 мс
[CPU]  Конечное состояние: 01100100011011000100...
[CUDA] Конечное состояние: 01100100011011000100...
[CPU]  Выходная последовательность (505 бит): 011110101001101010010001010110...
[CUDA] Выходная последовательность (505 бит): 011110101001101010010001010110...

✓ Результаты совпадают
Ускорение: 1.34x
```

#### 100K узлов
```
Узлов: 100000, Рёбер: 800709, Шагов: 50
Функция обратной связи: XOR

[CPU]  Время: 60.608 мс
[CUDA] Время: 7.057 мс
[CPU]  Конечное состояние: 11111111001001010110...
[CUDA] Конечное состояние: 11111111001001010110...
[CPU]  Выходная последовательность (255 бит): 111010101000001000111000001110...
[CUDA] Выходная последовательность (255 бит): 111010101000001000111000001110...

✓ Результаты совпадают
Ускорение: 8.59x ⚡
```

#### 1M узлов
```
Узлов: 1000000, Рёбер: 3998395, Шагов: 20
Функция обратной связи: XOR

[CPU]  Время: 192.260 мс
[CUDA] Время: 11.685 мс
[CPU]  Конечное состояние: 11011011110000010111...
[CUDA] Конечное состояние: 11011011110000010111...
[CPU]  Выходная последовательность (105 бит): 111100010111100011000001001010...
[CUDA] Выходная последовательность (105 бит): 111100010111100011000001001010...

✓ Результаты совпадают
Ускорение: 16.45x ⚡⚡⚡
```

### N-мерные решетки

#### 2D сетка 500x500
```
Узлов: 250000, Рёбер: 998000, Шагов: 100
Функция обратной связи: Majority

[CPU]  Время: 70.726 мс
[CUDA] Время: 16.601 мс
[CPU]  Конечное состояние: 00000000000000000000...
[CUDA] Конечное состояние: 00000000000000000000...
[CPU]  Выходная последовательность (505 бит): 100000000100010000010001000001...
[CUDA] Выходная последовательность (505 бит): 100000000100010000010001000001...

✓ Результаты совпадают
Ускорение: 4.26x ⚡
```

#### 3D куб 100x100x100
```
Узлов: 1000000, Рёбер: 5940000, Шагов: 50
Функция обратной связи: XOR

[CPU]  Время: 178.967 мс
[CUDA] Время: 45.801 мс
[CPU]  Конечное состояние: 10000010111100000111...
[CUDA] Конечное состояние: 10000010111100000111...
[CPU]  Выходная последовательность (255 бит): 110001111000010011011100000011...
[CUDA] Выходная последовательность (255 бит): 110001111000010011011100000011...

✓ Результаты совпадают
Ускорение: 3.91x ⚡
```

## Сводная таблица

```
╔════════════════════════════════════════════════════════════════════════════╗
║                         СВОДНАЯ ТАБЛИЦА РЕЗУЛЬТАТОВ                        ║
╚════════════════════════════════════════════════════════════════════════════╝

+---------------------------+--------------+--------------+--------------+--------------+
| Тест                      | CPU (мс)     | CUDA (мс)    | Ускорение    | Совпадение   |
+---------------------------+--------------+--------------+--------------+--------------+
| 1K узлов                  | 0.419        | 7.970        | 0.05x        | ДА           |
| 10K узлов                 | 9.392        | 7.020        | 1.34x        | ДА           |
| 100K узлов                | 60.608       | 7.057        | 8.59x        | ДА           |
| 1M узлов                  | 192.260      | 11.685       | 16.45x       | ДА           |
| 2D сетка 500x500          | 70.726       | 16.601       | 4.26x        | ДА           |
| 3D куб 100x100x100        | 178.967      | 45.801       | 3.91x        | ДА           |
+---------------------------+--------------+--------------+--------------+--------------+
```

## График производительности

```
╔════════════════════════════════════════════════════════════════════╗
║         ГРАФИК СРАВНЕНИЯ ПРОИЗВОДИТЕЛЬНОСТИ CPU vs CUDA           ║
╚════════════════════════════════════════════════════════════════════╝

1K узлов                  │
  CPU:  ▓ 0.42 мс
  CUDA: ▓▓▓▓▓▓▓▓▓▓ 7.97 мс (ускорение: 0.1x)

10K узлов                 │
  CPU:  ▓▓▓▓▓▓ 9.39 мс
  CUDA: ▓▓▓▓▓ 7.02 мс (ускорение: 1.3x)

100K узлов                │
  CPU:  ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓ 60.61 мс
  CUDA: ▓▓▓ 7.06 мс (ускорение: 8.6x)

1M узлов                  │
  CPU:  ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓ 192.26 мс
  CUDA: ▓▓▓ 11.69 мс (ускорение: 16.5x)

2D сетка 500x500          │
  CPU:  ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓ 70.73 мс
  CUDA: ▓▓▓▓▓▓▓▓ 16.60 мс (ускорение: 4.3x)

3D куб 100x100x100        │
  CPU:  ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓ 178.97 мс
  CUDA: ▓▓▓▓▓▓▓▓▓▓▓▓ 45.80 мс (ускорение: 3.9x)
```

## Анализ результатов

### Ускорение по размеру графа

| Размер | Ускорение | Комментарий |
|--------|-----------|-------------|
| 1K | 0.05x | Накладные расходы GPU превышают выгоду |
| 10K | 1.34x | Начальное ускорение |
| 100K | **8.59x** | Значительное ускорение |
| 1M | **16.45x** | Максимальное ускорение |

### Пропускная способность

**CPU**:
- 1K узлов: 239 млн ячеек/с
- 1M узлов: 104 млн ячеек/с

**CUDA**:
- 1K узлов: 13 млн ячеек/с (медленнее из-за накладных расходов)
- 1M узлов: **1710 млн ячеек/с** (в 16x быстрее!)

### Корректность

✅ **100% совпадение результатов между CPU и CUDA во всех тестах**:
- Конечные состояния идентичны
- Выходные последовательности совпадают побитово
- История эволюции совпадает на каждом шаге

## Выводы

1. **Задача полностью решена**: реализовано вычисление выходной последовательности обобщенного клеточного автомата по заданному графу и функции обратной связи.

2. **CUDA эффективна для больших графов**: достигнуто ускорение до **16.45x** на графе с 1 млн узлов.

3. **Выходная последовательность реализована**: извлечение значений из выбранных ячеек на каждом шаге с полным совпадением между CPU и GPU.

4. **N-мерные решетки поддержаны**: протестированы 2D и 3D решетки с различными окрестностями.

5. **Накладные расходы GPU**: для малых графов (<10K узлов) передача данных CPU↔GPU нивелирует преимущества параллелизма.

6. **3D куб показывает меньшее ускорение** (3.91x) по сравнению с 1M узлами (16.45x) из-за более высокой степени соседства (5.9 vs 4.0), что увеличивает нагрузку на память.

## Технические детали

### Исправленные проблемы

1. **Ошибка компиляции CUDA** (`unsupported toolchain`)
   - **Решение**: добавлена архитектура `-arch=sm_86` для RTX 3060
   
2. **Несовпадение результатов** (критическая ошибка)
   - **Решение**: добавлена синхронизация `cudaDeviceSynchronize()` после каждого kernel

3. **Отсутствие выходной последовательности**
   - **Решение**: реализована структура `OutputConfig` с извлечением битов

### Оптимизации

- CSR формат графа для эффективного доступа к памяти
- Double buffering (ping-pong) без копирования
- Блоки по 256 потоков (оптимально для Ampere)
- Синхронизация только при необходимости

## Файлы

- `output_full.txt` - полный вывод программы
- `cellular_automaton` - исполняемый файл
- Исходный код: https://github.com/SovesT1337/cellular_automaton

## Команды

```bash
# Компиляция
make

# Запуск
./cellular_automaton

# Результат сохранен в:
cat output_full.txt
```

